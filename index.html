<!--
 * @Descripttion: ~
 * @Author: 郭立华
 * @Date: 2021-10-12 09:55:15
 * @LastEditors: 郭立华
 * @LastEditTime: 2021-10-12 11:06:33
-->

<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>刮刮乐</title>
  <style type="text/css">
    html,
    body {
      margin: 0;
      padding: 0;
    }

    #c1 {
      border: 1px solid blue;
      position: absolute;
    }

    #c2 {
      border: 1px solid red;
    }

    body {
      position: relative;
    }
  </style>
</head>

<body>

  <canvas id="c1" width="960" height="1440"></canvas>

  <canvas id="c2" width="960" height="1440"></canvas>

</body>
<script type="text/javascript">
  var c1 = document.getElementById("c1");
  var c2 = document.getElementById("c2");

  var ctx1 = c1.getContext("2d");
  var ctx2 = c2.getContext("2d");


  // 绘制图片到底层  canvas2
  var imgs = new Image();
  imgs.style.width = '100%';
  imgs.style.height = '100%';
  imgs.src = 'img/girl.jpg';
  imgs.onload = function () {
    ctx2.drawImage(this, 0, 0)
  }

  // 涂层绘制到顶层(即覆盖膜)  canvas1
  ctx1.fillStyle = "lightgray";
  ctx1.fillRect(0, 0, 960, 1440);

  ctx1.font = "normal 80px 仿宋";
  ctx1.strokeStyle = "slateblue";
  ctx1.strokeText("请刮开！", 320, 750);

  // 监听canvas的onmousedown事件
  c1.ontouchstart = function (ev) {
    c1.ontouchmove = function (e) {
      console.log(e);
      var w = 50;      // 清除区域的宽度
      var h = 50;      // 清除区域的高度
      var x = e.pageX - c1.offsetLeft - w / 2;    // 清除区域的x位置
      var y = e.pageY - c1.offsetTop - h / 2;    // 清除区域的y位置
      ctx1.clearRect(x, y, w, h);
    }
  }
  c1.onTouchend = function (ev) {
    // 取消onmousemove事件
    c1.ontouchmove = null;
  }
</script>

</html>